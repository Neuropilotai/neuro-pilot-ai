# GROUP7 DAILY RUNBOOK - What Happens Each Day

## Timeline Overview

```
00:00 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       System idle, previous day's content published

02:00 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       ðŸ§  LEARNING LOOP STARTS
       â”œâ”€ Fetch last 7 days performance from Notion
       â”œâ”€ Query Metricool for engagement metrics
       â”œâ”€ Calculate scores (engagement Ã— views / 100)
       â”œâ”€ Rank top 5 videos and top 3 agents
       â”œâ”€ Generate recommendations
       â”œâ”€ Call GPT-4 to create optimized prompts
       â””â”€ Save adapted_prompts.json
       â±ï¸  Duration: ~5-10 minutes

06:00 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       ðŸ“¹ DAILY PRODUCTION STARTS
       Load optimized prompts from learning loop
       
06:05 â–¶ Agent 1: Lyra-7 (scheduled for 09:00 EST)
       â”œâ”€ Generate voice MP3
       â”œâ”€ Render Canva video
       â”œâ”€ Merge audio + video
       â”œâ”€ Upload to Google Drive
       â”œâ”€ Schedule on Metricool for 09:00
       â””â”€ Log to Notion
       â±ï¸  Duration: ~3 minutes

06:10 â–¶ Agent 2: Atlas (scheduled for 11:00 EST)
       [Same pipeline]
       
06:15 â–¶ Agent 3: Nova (scheduled for 13:00 EST)
       [Same pipeline]
       
06:20 â–¶ Agent 4: Cipher (scheduled for 15:00 EST)
       [Same pipeline]
       
06:25 â–¶ Agent 5: Echo (scheduled for 17:00 EST)
       [Same pipeline]
       
06:30 â–¶ Agent 6: Quantum (scheduled for 19:00 EST)
       [Same pipeline]
       
06:35 â–¶ Agent 7: Nexus (scheduled for 21:00 EST)
       [Same pipeline]
       
06:40 âœ… ALL VIDEOS PRODUCED AND SCHEDULED
       Total time: ~35 minutes
       Output: 7 videos in Google Drive
       Status: 7 posts scheduled in Metricool

09:00 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ðŸ“¤ Lyra-7 video publishes to TikTok/Instagram

11:00 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ðŸ“¤ Atlas video publishes

13:00 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ðŸ“¤ Nova video publishes

15:00 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ðŸ“¤ Cipher video publishes

17:00 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ðŸ“¤ Echo video publishes

19:00 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ðŸ“¤ Quantum video publishes

21:00 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ðŸ“¤ Nexus video publishes

Every ðŸ’“ HOURLY HEARTBEAT
Hour  â”œâ”€ Check API health (5 services)
       â”œâ”€ Measure latency
       â”œâ”€ Log to heartbeat_latest.json
       â””â”€ Alert if degraded

18:00 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       ðŸ“Š DAILY STATUS REPORT
       â”œâ”€ Count videos produced (last 24h)
       â”œâ”€ Calculate success rate
       â”œâ”€ Measure storage usage
       â”œâ”€ Generate report
       â””â”€ Log to Notion System DB
       â±ï¸  Duration: ~1 minute

23:59 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       Day complete. Repeat tomorrow.
```

---

## Detailed Process: Learning Loop (02:00 AM)

```javascript
Step 1: Analyze Performance (2-3 min)
  â”œâ”€ Fetch Notion videos (last 7 days, status=success)
  â”œâ”€ For each video:
  â”‚   â”œâ”€ Get Metricool stats (views, likes, comments, shares)
  â”‚   â”œâ”€ Calculate engagement = (likes+comments+shares)/views Ã— 100
  â”‚   â””â”€ Calculate score = engagement Ã— (views/100)
  â”œâ”€ Sort by score (descending)
  â”œâ”€ Group by agent
  â””â”€ Save analysis_latest.json

Step 2: Adapt Prompts (3-5 min)
  â”œâ”€ Load analysis results
  â”œâ”€ Identify top video (highest score)
  â”œâ”€ Identify top agent (highest avg score)
  â”œâ”€ Build GPT-4 system prompt:
  â”‚   "Replicate patterns from top video..."
  â”‚   "Maintain each agent's unique voice..."
  â”œâ”€ Call OpenAI API
  â”œâ”€ Parse JSON response (7 new scripts)
  â””â”€ Save adapted_prompts.json

Step 3: Commit Changes (optional, 1 min)
  â”œâ”€ If AUTO_COMMIT=true:
  â”‚   â”œâ”€ git add Production/logs/learning/*.json
  â”‚   â”œâ”€ git commit -m "chore: nightly learning"
  â”‚   â””â”€ git push (if AUTO_PUSH=true)
  â””â”€ Else: skip
```

---

## Detailed Process: Daily Production (06:00 AM)

```javascript
For each agent in schedule:
  
  Step 1: Voice Generation (20-30 sec)
    â”œâ”€ Load voice profile config/voices/{agent}.voice.json
    â”œâ”€ Get script from adapted_prompts.json
    â”œâ”€ Call ElevenLabs API
    â”œâ”€ Save MP3 to Production/Voice/GRP7_{agent}_{date}.mp3
    â””â”€ Verify file size > 10KB
  
  Step 2: Canva Render (30-60 sec)
    â”œâ”€ Call Canva Autofill API
    â”‚   â”œâ”€ Template: CANVA_TEMPLATE_ID
    â”‚   â”œâ”€ Data: hook_text, insight_text, cta_text
    â”‚   â””â”€ Get job_id
    â”œâ”€ Poll status every 5s (max 60 polls)
    â”œâ”€ Wait for status = "success"
    â””â”€ Get export URL (valid 24h)
  
  Step 3: CloudConvert Merge (30-90 sec)
    â”œâ”€ Create job:
    â”‚   â”œâ”€ Task 1: Import Canva MP4
    â”‚   â”œâ”€ Task 2: Import voice MP3
    â”‚   â”œâ”€ Task 3: Merge (h264, AAC 192k, -14 LUFS)
    â”‚   â””â”€ Task 4: Export to URL
    â”œâ”€ Poll status every 5s (max 120 polls)
    â”œâ”€ Wait for status = "finished"
    â””â”€ Get export URL (valid 1h)
  
  Step 4: Google Drive Upload (10-30 sec)
    â”œâ”€ Download merged MP4 to .tmp/
    â”œâ”€ Generate Service Account JWT
    â”œâ”€ Upload via multipart POST
    â”œâ”€ Get webViewLink and fileId
    â”œâ”€ Delete temp file
    â””â”€ Verify upload success
  
  Step 5: Metricool Schedule (5 sec)
    â”œâ”€ Call Metricool API
    â”œâ”€ Post data:
    â”‚   â”œâ”€ video_url: Google Drive link
    â”‚   â”œâ”€ caption: "{agent} insight + hashtags"
    â”‚   â”œâ”€ scheduled_time: {agent's time slot}
    â”‚   â””â”€ external_id: "{agent}-{date}"
    â””â”€ Get post_id
  
  Step 6: Notion Log (2 sec)
    â”œâ”€ Create page in Video Production DB
    â”œâ”€ Properties:
    â”‚   â”œâ”€ Name: GRP7_{agent}_{date}
    â”‚   â”œâ”€ Agent: {agent}
    â”‚   â”œâ”€ Status: success
    â”‚   â”œâ”€ Drive Link: webViewLink
    â”‚   â””â”€ Created: timestamp
    â””â”€ Get notion_page_id
  
  Total per video: ~2-3 minutes
  Total for 7 videos: ~20-30 minutes (sequential)
```

---

## Error Scenarios & Recovery

### Scenario 1: Canva Render Timeout
**Symptom**: Poll reaches 60 attempts (5 min) without success
**Recovery**:
- Retry entire video production (max 2 retries)
- If still fails, skip to next agent
- Log failure to Notion (status = failed)
- Alert via configured channel

### Scenario 2: CloudConvert Job Fails
**Symptom**: Job status = "error"
**Recovery**:
- Check CloudConvert dashboard for error details
- Common causes: Invalid video URL, out of credits
- Retry with exponential backoff
- If persistent, manual intervention required

### Scenario 3: Metricool Publishing Fails
**Symptom**: HTTP 401 or 403
**Recovery**:
- Verify METRICOOL_API_KEY is valid
- Check profile permissions
- Video still saved in Drive
- Can manually publish later

### Scenario 4: Learning Loop Fails
**Symptom**: No adapted_prompts.json generated
**Recovery**:
- Scheduler uses previous day's prompts
- Or falls back to defaults
- System continues operating
- Fix learning loop for next night

---

## Manual Overrides

### Skip Learning Loop (use custom prompts)
```bash
# Create custom prompts
cat > Production/logs/learning/adapted_prompts.json << 'EOF'
{
  "scripts": [
    {"agent": "Lyra-7", "hook": "...", "insight": "...", "cta": "..."},
    ...
  ]
}
EOF

# Run scheduler (will use your custom prompts)
npm run schedule:daily
```

### Skip Scheduler (produce one video)
```bash
npm run run:one -- \
  --agent Lyra \
  --slug custom_2025_11_02 \
  --hook "Your hook" \
  --insight "Your insight" \
  --cta "Your CTA"
```

### Force Re-Analysis (debug learning)
```bash
# Delete cache
rm Production/logs/learning/analysis_latest.json

# Re-run analysis
npm run learn:analyze

# Check results
cat Production/logs/learning/analysis_latest.json | jq .topVideos
```

---

## Monitoring Checklist

### Daily (automated):
- âœ… Learning loop completes
- âœ… 7 videos produced
- âœ… 7 posts scheduled
- âœ… Status report generated

### Weekly (manual review):
- Review top videos: `cat Production/logs/learning/analysis_latest.json | jq .topVideos`
- Check engagement trends
- Verify storage usage: `du -sh Production/Video/`
- Review failure rate: `npm run monitor:status`

### Monthly (strategic):
- Compare month-over-month engagement
- Analyze agent performance trends
- Adjust posting times if needed
- Add new agents or platforms

---

## Success Metrics

**Daily:**
- Videos produced: 7/7 âœ…
- Success rate: > 85% âœ…
- Avg processing time: < 5 min/video âœ…

**Weekly:**
- Total views: Trending up âœ…
- Engagement rate: > 3% âœ…
- System uptime: > 99% âœ…

**Monthly:**
- Content improvement: +10-20% engagement âœ…
- Cost per video: < $0.20 âœ…
- Manual interventions: < 5/month âœ…

---

**The system runs itself. You just watch it improve.** ðŸš€
