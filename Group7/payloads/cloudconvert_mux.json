{
  "comment": "CloudConvert - Merge video + audio into final MP4",
  "endpoint": "POST https://api.cloudconvert.com/v2/jobs",
  "headers": {
    "Authorization": "Bearer {CLOUDCONVERT_API_KEY}",
    "Content-Type": "application/json"
  },
  "request_body": {
    "tasks": {
      "import-video": {
        "operation": "import/url",
        "url": "https://export-download.canva.com/DAFxxx/video.mp4",
        "filename": "canva_video.mp4"
      },
      "import-audio": {
        "operation": "import/url",
        "url": "https://storage.googleapis.com/voice/audio.mp3",
        "filename": "voice.mp3"
      },
      "merge": {
        "operation": "merge",
        "input": [
          "import-video",
          "import-audio"
        ],
        "output_format": "mp4",
        "video_codec": "h264",
        "crf": 22,
        "preset": "medium",
        "audio_codec": "aac",
        "audio_bitrate": "192",
        "audio_normalize": "loudnorm",
        "loudness_target": "-14"
      },
      "export": {
        "operation": "export/url",
        "input": "merge"
      }
    },
    "tag": "group7-video-{AGENT}-{SLUG}"
  },
  "response_example": {
    "data": {
      "id": "2c4c8c69-5e87-4a8b-8e26-4ed3f5555555",
      "status": "waiting",
      "created_at": "2025-11-02T12:00:00+00:00",
      "tasks": [
        {
          "id": "task-1",
          "name": "import-video",
          "operation": "import/url",
          "status": "waiting"
        },
        {
          "id": "task-2",
          "name": "import-audio",
          "operation": "import/url",
          "status": "waiting"
        },
        {
          "id": "task-3",
          "name": "merge",
          "operation": "merge",
          "status": "waiting"
        },
        {
          "id": "task-4",
          "name": "export",
          "operation": "export/url",
          "status": "waiting"
        }
      ]
    }
  },
  "polling": {
    "endpoint": "GET https://api.cloudconvert.com/v2/jobs/{job_id}",
    "poll_interval_seconds": 5,
    "max_polls": 120,
    "success_status": "finished",
    "response_when_complete": {
      "data": {
        "id": "2c4c8c69-5e87-4a8b-8e26-4ed3f5555555",
        "status": "finished",
        "tasks": [
          {
            "id": "export-task-id",
            "name": "export",
            "operation": "export/url",
            "status": "finished",
            "result": {
              "files": [
                {
                  "filename": "output.mp4",
                  "url": "https://storage.cloudconvert.com/xxx/output.mp4?temp_url_sig=xxx"
                }
              ]
            }
          }
        ]
      }
    }
  },
  "notes": [
    "CloudConvert processes in stages: import → process → export",
    "Poll job status until all tasks finished",
    "Export URL in result.files[0].url (temporary, download ASAP)",
    "Audio normalization to -14 LUFS ensures consistent volume",
    "CRF 22 balances quality and file size (lower = better)",
    "Tag helps track jobs in CloudConvert dashboard"
  ]
}
