# Nixpacks Configuration for Railway
# Railway runs from neuro-pilot-ai directory, so paths need inventory-enterprise prefix

[phases.setup]
nixPkgs = ["nodejs_20"]

[phases.install]
cmds = ["cd inventory-enterprise/backend && npm ci --omit=dev"]

[phases.build]
cmds = [
  "cd inventory-enterprise/backend && npm install --production=false",
  "mkdir -p inventory-enterprise/backend/public",
  "cp -r inventory-enterprise/frontend/public/* inventory-enterprise/backend/public/ || true",
  "echo 'âœ… Copied frontend files to backend/public'",
  "ls -la inventory-enterprise/backend/public | head -10 || true"
]

[start]
cmd = "cd inventory-enterprise/backend && node scripts/init-postgres.js && node server-v21_1.js"
