# Nixpacks Configuration for Railway
# Forces Railway to use our exact commands

[phases.setup]
nixPkgs = ["nodejs_20"]

[phases.install]
cmds = ["npm ci --omit=dev"]

[phases.build]
cmds = [
  "npm install --production=false",
  "mkdir -p public",
  "if [ -d ../frontend/public ]; then cp -r ../frontend/public/* ./public/ && echo '✅ Copied frontend files to ./public'; else echo '⚠️  Frontend not found - will serve from backend directory'; fi",
  "ls -la public || echo 'No public directory created'"
]

[start]
cmd = "node server-v20_1.js"
